<div class="dom-demo">
  <!-- HEADER -->
  <header class="dom-demo__header">
    <h1 class="dom-demo__title">Demostración de Rúbrica 1.3</h1>
    <p class="dom-demo__subtitle">
      Creación y Eliminación de Elementos del DOM con Renderer2
    </p>
  </header>

  <!-- SECCIÓN 1: CREACIÓN Y ELIMINACIÓN -->
  <section class="dom-demo__section">
    <div class="dom-demo__section-header">
      <h2 class="dom-demo__section-title">
        <span class="badge badge--success">1.3</span>
        1. Creación y Eliminación de Elementos
      </h2>
      <p class="dom-demo__description">
        Uso de <code>createElement()</code>, <code>appendChild()</code> y <code>removeChild()</code> con Renderer2
      </p>
    </div>

    <div class="dom-demo__card">
      <h3>Crear Tarjeta Dinámica</h3>

      <div class="form-group">
        <label for="card-title">Título de la tarjeta:</label>
        <input
          id="card-title"
          type="text"
          [(ngModel)]="cardTitle"
          placeholder="Ingresa un título"
          class="form-input"
          (keyup.enter)="createCard()">
      </div>

      <div class="form-group">
        <label for="card-content">Contenido (opcional):</label>
        <textarea
          id="card-content"
          [(ngModel)]="cardContent"
          placeholder="Ingresa contenido"
          class="form-input"
          rows="3"></textarea>
      </div>

      <div class="button-group">
        <button (click)="createCard()" class="btn btn--primary">
          Crear Tarjeta
        </button>
        <button (click)="clearAllCards()" class="btn btn--secondary">
          Eliminar Todas
        </button>
      </div>

      <div class="stats">
        <span class="badge badge--info">Tarjetas creadas: {{ createdCardsCount }}</span>
      </div>

      <!-- Contenedor dinámico -->
      <div #dynamicContainer class="dynamic-container"></div>

      <div class="dom-demo__code">
        <h4>Código TypeScript:</h4>
        <pre><code>createCard(): void &#123;
  // 1. Crear elementos
  const card = this.renderer.createElement('div');
  const header = this.renderer.createElement('div');
  const title = this.renderer.createElement('h3');

  // 2. Agregar clases
  this.renderer.addClass(card, 'dynamic-card');

  // 3. Crear texto
  const titleText = this.renderer.createText(this.cardTitle);
  this.renderer.appendChild(title, titleText);

  // 4. Ensamblar elementos
  this.renderer.appendChild(header, title);
  this.renderer.appendChild(card, header);

  // 5. Agregar al DOM
  this.renderer.appendChild(this.container.nativeElement, card);

  // 6. Guardar referencia para limpieza
  this.createdElements.push(card);
&#125;

removeCard(card: any): void &#123;
  // Eliminar del DOM con removeChild
  this.renderer.removeChild(
    this.container.nativeElement,
    card
  );
&#125;</code></pre>

        <h4>Ubicación real:</h4>
        <ul>
          <li><code>src/app/pages/dom-demo/dom-demo.ts</code> líneas 75-145</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- SECCIÓN 2: CLONACIÓN DE NODOS -->
  <section class="dom-demo__section">
    <div class="dom-demo__section-header">
      <h2 class="dom-demo__section-title">
        <span class="badge badge--success">1.3</span>
        2. Clonación de Nodos
      </h2>
      <p class="dom-demo__description">
        Uso de <code>cloneNode()</code> para duplicar elementos existentes
      </p>
    </div>

    <div class="dom-demo__card">
      <h3>Clonar Tarjetas</h3>

      <p class="info-text">
        Primero crea una tarjeta arriba, luego clónala aquí:
      </p>

      <div class="button-group">
        <button (click)="cloneFirstCard()" class="btn btn--primary">
          Clonar Primera Tarjeta
        </button>
        <button (click)="clearClonedCards()" class="btn btn--secondary">
          Eliminar Clones
        </button>
      </div>

      <div class="stats">
        <span class="badge badge--warning">Clones creados: {{ clonedCardsCount }}</span>
      </div>

      <!-- Contenedor de clones -->
      <div #cloneContainer class="dynamic-container clone-container"></div>

      <div class="dom-demo__code">
        <h4>Código TypeScript:</h4>
        <pre><code>cloneFirstCard(): void &#123;
  const firstCard = this.container.nativeElement.children[0];

  // Clonar nodo (true = deep clone, incluye hijos)
  const clonedCard = firstCard.cloneNode(true);

  // Modificar el clon
  const cloneHeader = clonedCard.querySelector('h3');
  cloneHeader.textContent = `[CLON] $&#123;cloneHeader.textContent&#125;`;

  // Agregar clase especial
  this.renderer.addClass(clonedCard, 'cloned-card');

  // Re-agregar event listeners al clon
  const deleteBtn = clonedCard.querySelector('.btn-delete');
  this.renderer.listen(deleteBtn, 'click', () => &#123;
    this.removeCard(clonedCard);
  &#125;);

  // Agregar al contenedor de clones
  this.renderer.appendChild(
    this.cloneContainer.nativeElement,
    clonedCard
  );
&#125;</code></pre>

        <h4>Ubicación real:</h4>
        <ul>
          <li><code>src/app/pages/dom-demo/dom-demo.ts</code> líneas 158-210</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- SECCIÓN 3: COMPONENTE 1 - DYNAMIC LIST -->
  <section class="dom-demo__section">
    <div class="dom-demo__section-header">
      <h2 class="dom-demo__section-title">
        <span class="badge badge--success">1.3</span>
        3. Componente 1: Lista Dinámica
      </h2>
      <p class="dom-demo__description">
        Creación dinámica de elementos de lista con Renderer2
      </p>
    </div>

    <div class="dom-demo__card">
      <app-dynamic-list></app-dynamic-list>

      <div class="dom-demo__code">
        <h4>Características:</h4>
        <ul>
          <li>✓ Crea elementos <code>&lt;li&gt;</code> dinámicamente con <code>createElement()</code></li>
          <li>✓ Agrega elementos con <code>appendChild()</code></li>
          <li>✓ Elimina elementos con <code>removeChild()</code></li>
          <li>✓ Limpia en <code>ngOnDestroy()</code></li>
        </ul>

        <h4>Ubicación:</h4>
        <ul>
          <li><code>src/components/demos/dynamic-list/dynamic-list.ts</code></li>
        </ul>
      </div>
    </div>
  </section>

  <!-- SECCIÓN 4: COMPONENTE 2 - TOAST NOTIFICATIONS -->
  <section class="dom-demo__section">
    <div class="dom-demo__section-header">
      <h2 class="dom-demo__section-title">
        <span class="badge badge--success">1.3</span>
        4. Componente 2: Sistema de Notificaciones
      </h2>
      <p class="dom-demo__description">
        Creación y eliminación automática de notificaciones toast
      </p>
    </div>

    <div class="dom-demo__card">
      <app-toast-container></app-toast-container>

      <div class="dom-demo__code">
        <h4>Características:</h4>
        <ul>
          <li>✓ Crea notificaciones dinámicamente con <code>createElement()</code></li>
          <li>✓ Agrega al contenedor con <code>appendChild()</code></li>
          <li>✓ Elimina automáticamente después de 3s con <code>removeChild()</code></li>
          <li>✓ Gestiona múltiples notificaciones simultáneas</li>
          <li>✓ Limpia timers en <code>ngOnDestroy()</code></li>
        </ul>

        <h4>Ubicación:</h4>
        <ul>
          <li><code>src/components/demos/toast-container/toast-container.ts</code></li>
        </ul>
      </div>
    </div>
  </section>

  <!-- SECCIÓN 5: COMPONENTE 3 - PARTICLE SYSTEM -->
  <section class="dom-demo__section">
    <div class="dom-demo__section-header">
      <h2 class="dom-demo__section-title">
        <span class="badge badge--success">1.3</span>
        5. Componente 3: Sistema de Partículas
      </h2>
      <p class="dom-demo__description">
        Creación masiva de elementos con animaciones
      </p>
    </div>

    <div class="dom-demo__card">
      <app-particle-system></app-particle-system>

      <div class="dom-demo__code">
        <h4>Características:</h4>
        <ul>
          <li>✓ Crea múltiples partículas (elementos div) con <code>createElement()</code></li>
          <li>✓ Agrega al contenedor con <code>appendChild()</code></li>
          <li>✓ Aplica estilos dinámicos con <code>setStyle()</code></li>
          <li>✓ Elimina partículas después de la animación con <code>removeChild()</code></li>
          <li>✓ Gestiona correctamente el ciclo de vida</li>
        </ul>

        <h4>Ubicación:</h4>
        <ul>
          <li><code>src/components/demos/particle-system/particle-system.ts</code></li>
        </ul>
      </div>
    </div>
  </section>

  <!-- SECCIÓN 6: GESTIÓN DEL CICLO DE VIDA -->
  <section class="dom-demo__section">
    <div class="dom-demo__section-header">
      <h2 class="dom-demo__section-title">
        <span class="badge badge--success">1.3</span>
        6. Gestión del Ciclo de Vida
      </h2>
      <p class="dom-demo__description">
        Limpieza correcta con <code>ngOnDestroy()</code>
      </p>
    </div>

    <div class="dom-demo__card">
      <h3>Implementación de ngOnDestroy()</h3>

      <p class="info-text">
        Todos los componentes implementan <code>ngOnDestroy()</code> para limpiar elementos creados,
        event listeners y timers, evitando memory leaks.
      </p>

      <div class="dom-demo__code">
        <h4>Código TypeScript:</h4>
        <pre><code>export class DomDemoComponent implements OnDestroy &#123;
  private createdElements: any[] = [];
  private intervalIds: any[] = [];

  createCard(): void &#123;
    const card = this.renderer.createElement('div');
    // ... crear elemento ...

    // Guardar referencia para limpieza
    this.createdElements.push(card);
  &#125;

  ngOnDestroy(): void &#123;
    console.log('Limpiando elementos...');

    // 1. Limpiar intervalos
    this.intervalIds.forEach(id => clearInterval(id));

    // 2. Eliminar elementos del DOM
    this.createdElements.forEach(element => &#123;
      if (element && element.parentNode) &#123;
        this.renderer.removeChild(element.parentNode, element);
      &#125;
    &#125;);

    // 3. Limpiar referencias
    this.createdElements = [];
    this.intervalIds = [];
  &#125;
&#125;</code></pre>

        <h4>Componentes con ngOnDestroy():</h4>
        <ul>
          <li><code>dom-demo.ts</code> líneas 270-291</li>
          <li><code>dynamic-list.ts</code></li>
          <li><code>toast-container.ts</code></li>
          <li><code>particle-system.ts</code></li>
        </ul>
      </div>
    </div>
  </section>

  <!-- RESUMEN FINAL -->
  <section class="dom-demo__section">
    <div class="dom-demo__section-header">
      <h2 class="dom-demo__section-title">
        Resumen de Implementaciones
      </h2>
    </div>

    <div class="dom-demo__card">
      <h3>Rúbrica 1.3: Creación y Eliminación de Elementos del DOM</h3>

      <p><strong>Componentes que usan Renderer2:</strong></p>
      <ol>
        <li><strong>DomDemoComponent</strong> (esta página) - <code>dom-demo.ts</code></li>
        <li><strong>DynamicListComponent</strong> - <code>dynamic-list.ts</code></li>
        <li><strong>ToastContainerComponent</strong> - <code>toast-container.ts</code></li>
        <li><strong>ParticleSystemComponent</strong> - <code>particle-system.ts</code></li>
      </ol>

      <p><strong>Técnicas implementadas:</strong></p>
      <ul>
        <li>✓ <code>createElement()</code> - Creación de elementos</li>
        <li>✓ <code>appendChild()</code> - Agregar elementos al DOM</li>
        <li>✓ <code>removeChild()</code> - Eliminar elementos del DOM</li>
        <li>✓ <code>cloneNode()</code> - Clonación de nodos</li>
        <li>✓ <code>createText()</code> - Creación de nodos de texto</li>
        <li>✓ <code>addClass()</code> / <code>removeClass()</code> - Manipulación de clases</li>
        <li>✓ <code>setStyle()</code> - Aplicación de estilos</li>
        <li>✓ <code>setAttribute()</code> - Configuración de atributos</li>
        <li>✓ <code>listen()</code> - Event listeners seguros</li>
        <li>✓ <code>ngOnDestroy()</code> - Limpieza correcta del ciclo de vida</li>
      </ul>

      <p><strong>TOTAL: 4 componentes con manipulación completa del DOM usando Renderer2 ✓</strong></p>

      <div class="alert alert--success">
        <strong>✓ Cumple con todos los requisitos para 10/10 puntos</strong>
        <br>
        <small>Crea elementos con createElement() y appendChild() usando Renderer2 en 3+ componentes</small>
        <br>
        <small>Elimina elementos con removeChild()</small>
        <br>
        <small>Implementa clonación de nodos</small>
        <br>
        <small>Gestiona correctamente la limpieza en ngOnDestroy()</small>
      </div>
    </div>
  </section>
</div>
