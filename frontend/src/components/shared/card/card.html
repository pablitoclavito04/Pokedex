<!-- ============================================================================
     CARD COMPONENT

     Componente de tarjeta reutilizable con variantes vertical, horizontal y pokemon.

     Variantes: vertical (default), horizontal, pokemon
     Incluye: imagen, título, subtítulo, descripción, acción
     Estados: normal, hover, clickable, elevated
     ============================================================================ -->

<!-- ========== VARIANTE POKEMON ========== -->
@if (variant === 'pokemon') {
  <article
    [class]="cardClasses"
    [attr.role]="clickable ? 'button' : null"
    [attr.tabindex]="clickable ? 0 : null"
    (click)="onCardClick()"
    (keydown.enter)="onCardClick()"
    (keydown.space)="onCardClick()">

    <!-- Número de fondo (watermark) -->
    @if (pokemonNumber) {
      <span class="card__watermark" aria-hidden="true">#{{ pokemonNumber }}</span>
    }

    <!-- Botón de favorito -->
    <button
      type="button"
      class="card__favorite-btn"
      [class.card__favorite-btn--active]="isFavorite"
      [attr.aria-label]="isFavorite ? 'Quitar de favoritos' : 'Añadir a favoritos'"
      [attr.aria-pressed]="isFavorite"
      (click)="onFavoriteClick($event)">
      <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
      </svg>
    </button>

    <!-- Imagen del Pokémon -->
    @if (imageUrl) {
      <div class="card__pokemon-image">
        <img
          [src]="imageUrl"
          [alt]="imageAlt || title"
          loading="lazy">
      </div>
    }

    <!-- Nombre y número -->
    <div class="card__pokemon-info">
      <h3 class="card__pokemon-name">{{ title }}</h3>
      @if (pokemonNumber) {
        <span class="card__pokemon-number">#{{ pokemonNumber }}</span>
      }
    </div>

    <!-- Número entre nombre y tipos -->
    @if (pokemonNumber) {
      <span class="card__pokemon-number-display">#{{ pokemonNumber }}</span>
    }

    <!-- Tipos -->
    @if (types.length > 0) {
      <div class="card__pokemon-types">
        @for (type of types; track type.name) {
          <span
            class="card__type-badge"
            [style.background-color]="type.color">
            @if (type.icon) {
              <span class="card__type-icon">{{ type.icon }}</span>
            }
            {{ type.name }}
          </span>
        }
      </div>
    }

    <!-- Botón de acción -->
    @if (actionText) {
      <button
        type="button"
        class="card__pokemon-action"
        (click)="onActionClick($event)">
        <svg class="card__pokemon-action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="12" r="10"/>
          <circle cx="12" cy="12" r="3"/>
          <line x1="12" y1="2" x2="12" y2="9"/>
          <line x1="12" y1="15" x2="12" y2="22"/>
        </svg>
        {{ actionText }}
      </button>
    }

  </article>
} @else {
  <!-- ========== VARIANTES VERTICAL/HORIZONTAL ========== -->
  <article
    [class]="cardClasses"
    [attr.role]="clickable ? 'button' : null"
    [attr.tabindex]="clickable ? 0 : null"
    (click)="onCardClick()"
    (keydown.enter)="onCardClick()"
    (keydown.space)="onCardClick()">

    <!-- Número de fondo (watermark) para horizontal -->
    @if (variant === 'horizontal' && pokemonNumber) {
      <span class="card__watermark" aria-hidden="true">#{{ pokemonNumber }}</span>
    }

    <!-- Botón de favorito para horizontal -->
    @if (variant === 'horizontal') {
      <button
        type="button"
        class="card__favorite-btn"
        [class.card__favorite-btn--active]="isFavorite"
        [attr.aria-label]="isFavorite ? 'Quitar de favoritos' : 'Añadir a favoritos'"
        [attr.aria-pressed]="isFavorite"
        (click)="onFavoriteClick($event)">
        <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
      </button>
    }

    <!-- ========== IMAGEN ========== -->
    @if (imageUrl) {
      <div class="card__image-wrapper">
        <img
          [src]="imageUrl"
          [alt]="imageAlt || title"
          class="card__image"
          loading="lazy">
      </div>
    }

    <!-- ========== CONTENIDO ========== -->
    <div class="card__content">

      <!-- Header: Título y Subtítulo -->
      @if (title || subtitle) {
        <header class="card__header">
          @if (subtitle && variant !== 'horizontal') {
            <p class="card__subtitle">{{ subtitle }}</p>
          }
          @if (title) {
            <h3 class="card__title">{{ title }}</h3>
          }
          <!-- Número al lado del nombre para horizontal -->
          @if (variant === 'horizontal' && pokemonNumber) {
            <span class="card__pokemon-number-inline">#{{ pokemonNumber }}</span>
          }
          <!-- Tipos debajo del nombre para horizontal -->
          @if (variant === 'horizontal' && types.length > 0) {
            <div class="card__pokemon-types">
              @for (type of types; track type.name) {
                <span
                  class="card__type-badge"
                  [style.background-color]="type.color">
                  @if (type.icon) {
                    <span class="card__type-icon">{{ type.icon }}</span>
                  }
                  {{ type.name }}
                </span>
              }
            </div>
          }
        </header>
      }

      <!-- Body: Descripción -->
      @if (description) {
        <div class="card__body">
          <p class="card__description">{{ description }}</p>
        </div>
      }

      <!-- Contenido proyectado adicional -->
      <div class="card__extra">
        <ng-content></ng-content>
      </div>

      <!-- Footer: Acciones para vertical -->
      @if (actionText && variant === 'vertical') {
        <footer class="card__footer">
          <button
            type="button"
            class="card__action"
            (click)="onActionClick($event)">
            {{ actionText }}
            <svg class="card__action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
          </button>
        </footer>
      }

      <!-- Botón de acción estilo pokemon para horizontal -->
      @if (actionText && variant === 'horizontal') {
        <button
          type="button"
          class="card__pokemon-action"
          (click)="onActionClick($event)">
          <svg class="card__pokemon-action-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <circle cx="12" cy="12" r="10"/>
            <circle cx="12" cy="12" r="3"/>
            <line x1="12" y1="2" x2="12" y2="9"/>
            <line x1="12" y1="15" x2="12" y2="22"/>
          </svg>
          {{ actionText }}
        </button>
      }

    </div>

  </article>
}
