// ============================================================================
//                    ACCORDION COMPONENT - Estilos BEM
// ============================================================================
// Bloque: .accordion
// Elementos: __item, __header, __button, __icon, __title, __indicator, __panel, __content
// Modificadores: --default, --bordered, --separated, --open, --disabled

@use '../../../styles/00-settings/variables' as *;
@use '../../../styles/01-tools/mixins' as *;

// ============================================================================
//                      BLOQUE PRINCIPAL: .accordion
// ============================================================================
.accordion {
  display: flex;
  flex-direction: column;
  width: 100%;

  // ============================================================================
  //                               ELEMENTO: Item
  // ============================================================================
  &__item {
    border-bottom: 1px solid var(--border-secondary, #{map-get($light-theme, border-secondary)});

    &:last-child {
      border-bottom: none;
    }

    // Estado abierto
    &--open {
      .accordion__indicator {
        transform: rotate(180deg);
      }

      .accordion__panel {
        grid-template-rows: 1fr;
      }
    }

    // Estado deshabilitado
    &--disabled {
      opacity: 0.5;

      .accordion__button {
        cursor: not-allowed;
      }
    }
  }

  // ============================================================================
  //                               ELEMENTO: Header
  // ============================================================================
  &__header {
    margin: 0;
    padding: 0;
  }

  // ============================================================================
  //                               ELEMENTO: Button
  // ============================================================================
  &__button {
    // Reset
    background: transparent;
    border: none;
    cursor: pointer;
    font-family: $font-primary;
    text-align: left;

    // Layout
    display: flex;
    align-items: center;
    gap: $spacing-3;
    width: 100%;
    padding: $spacing-4;

    // Estilos
    color: var(--text-primary);
    font-size: $font-size-base;
    font-weight: $font-weight-medium;

    transition: background $duration-fast $ease-out;

    &:hover:not(:disabled) {
      background: var(--bg-tertiary);
    }

    &:focus-visible {
      outline: 2px solid var(--color-primary);
      outline-offset: -2px;
    }
  }

  // ============================================================================
  //                               ELEMENTO: Icon
  // ============================================================================
  &__icon {
    display: inline-flex;
    align-items: center;
    font-size: 1.2em;
    flex-shrink: 0;
  }

  // ============================================================================
  //                               ELEMENTO: Title
  // ============================================================================
  &__title {
    flex: 1;
    min-width: 0;
  }

  // ============================================================================
  //                               ELEMENTO: Indicator
  // ============================================================================
  &__indicator {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    width: 20px;
    height: 20px;
    color: var(--text-tertiary);
    transition: transform $duration-base $ease-out;

    svg {
      width: 100%;
      height: 100%;
    }
  }

  // ============================================================================
  //                               ELEMENTO: Panel
  // ============================================================================
  &__panel {
    // Animación con CSS Grid para altura automática
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows $duration-base $ease-out;
    overflow: hidden;
  }

  // ============================================================================
  //                               ELEMENTO: Content
  // ============================================================================
  &__content {
    min-height: 0;
    padding: 0 $spacing-4;
    color: var(--text-secondary);
    line-height: $line-height-relaxed;

    // Padding inferior solo cuando está abierto
    .accordion__item--open & {
      padding-bottom: $spacing-4;
    }
  }

  // ============================================================================
  //                               VARIANTES
  // ============================================================================

  // VARIANTE: Default (ya definido)
  &--default {
    // Estilos base
  }

  // VARIANTE: Bordered (con bordes completos)
  &--bordered {
    border: 2px solid var(--text-primary, #{map-get($light-theme, text-primary)});
    border-radius: $border-radius-lg;
    overflow: hidden;

    .accordion__item {
      border-bottom: 1px solid var(--border-secondary, #{map-get($light-theme, border-secondary)});

      &:last-child {
        border-bottom: none;
      }
    }
  }

  // VARIANTE: Separated (ítems separados)
  &--separated {
    gap: $spacing-2;

    .accordion__item {
      border: 1px solid var(--border-primary);
      border-radius: $border-radius-md;
      background: var(--bg-secondary);

      &--open {
        box-shadow: var(--shadow-sm);
      }
    }

    .accordion__button {
      border-radius: $border-radius-md;
    }
  }
}

// ============================================================================
//                           RESPONSIVE
// ============================================================================
@include respond-to(sm) {
  .accordion {
    &__button {
      padding: $spacing-3;
      font-size: $font-size-sm;
    }

    &__content {
      padding: 0 $spacing-3;
      font-size: $font-size-sm;

      .accordion__item--open & {
        padding-bottom: $spacing-3;
      }
    }
  }
}
