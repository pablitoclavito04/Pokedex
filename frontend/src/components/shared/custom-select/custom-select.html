<div class="custom-select"
     [class.custom-select--open]="isOpen"
     [class.custom-select--upward]="openUpward"
     [class.custom-select--disabled]="disabled"
     [class.custom-select--error]="hasError"
     [class.custom-select--filled]="hasValue">

  <!-- Botón trigger -->
  <button
    type="button"
    class="custom-select__trigger"
    [attr.id]="selectId"
    [attr.aria-expanded]="isOpen"
    [attr.aria-haspopup]="'listbox'"
    [disabled]="disabled"
    (click)="toggleDropdown()">
    <span class="custom-select__value" [class.custom-select__value--placeholder]="!hasValue">
      {{ selectedLabel }}
    </span>
    <svg class="custom-select__arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M6 9l6 6 6-6"/>
    </svg>
  </button>

  <!-- Dropdown -->
  @if (isOpen) {
    <div class="custom-select__dropdown" role="listbox">
      <div class="custom-select__options-wrapper"
           [class.custom-select__options-wrapper--scrolled-top]="isScrolledFromTop"
           [class.custom-select__options-wrapper--scrolled-bottom]="isScrolledToBottom"
           [class.custom-select__options-wrapper--no-scroll]="!hasScroll">
        <div class="custom-select__options"
             #optionsContainer
             (scroll)="onOptionsScroll($event)">
          @for (option of options; track option.value) {
            <button
              type="button"
              class="custom-select__option"
              [class.custom-select__option--selected]="option.value === value"
              [class.custom-select__option--disabled]="option.disabled"
              role="option"
              [attr.aria-selected]="option.value === value"
              [disabled]="option.disabled"
              (click)="selectOption(option)">
              {{ option.label }}
            </button>
          }
        </div>
        <!-- Scrollbar custom para móviles -->
        @if (hasScroll) {
          <div class="custom-select__scrollbar">
            <div class="custom-select__scrollbar-thumb"
                 [style.height.%]="scrollThumbHeight"
                 [style.top.%]="scrollThumbPosition">
            </div>
          </div>
        }
      </div>
    </div>
  }
</div>