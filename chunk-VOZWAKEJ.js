import{I as s,M as a,Q as n,h as i,nc as o}from"./chunk-7PQTO6SL.js";var g=class r{constructor(e){this.http=e}apiUrl="https://pokedex-backend-mwcz.onrender.com/api/auth";tokenKey="token";isLoggedInSubject=new i(this.hasToken());isLoggedIn$=this.isLoggedInSubject.asObservable();login(e){return this.http.post(`${this.apiUrl}/login`,e).pipe(s(t=>{this.saveUserData(t),sessionStorage.setItem("userPassword",e.password),this.isLoggedInSubject.next(!0)}))}register(e){return this.http.post(`${this.apiUrl}/register`,e).pipe(s(t=>{this.saveUserData(t),sessionStorage.setItem("userPassword",e.password),this.isLoggedInSubject.next(!0)}))}updateProfile(e){return this.http.put(`${this.apiUrl}/profile`,e).pipe(s(t=>{this.saveUserData(t)}))}logout(){sessionStorage.clear(),this.isLoggedInSubject.next(!1)}deleteAccount(){return this.http.delete(`${this.apiUrl}/delete-account`,{responseType:"text"}).pipe(s(()=>{sessionStorage.clear(),this.isLoggedInSubject.next(!1)}))}saveUserData(e){sessionStorage.setItem(this.tokenKey,e.token),sessionStorage.setItem("username",e.username),sessionStorage.setItem("email",e.email),e.displayName&&sessionStorage.setItem("displayName",e.displayName),e.bio&&sessionStorage.setItem("userBio",e.bio),e.gender&&sessionStorage.setItem("userGender",e.gender),e.favoriteRegion&&sessionStorage.setItem("userFavoriteRegion",e.favoriteRegion),e.language&&sessionStorage.setItem("userLanguage",e.language),e.avatar&&sessionStorage.setItem("userAvatar",e.avatar)}getToken(){return sessionStorage.getItem(this.tokenKey)}getUsername(){return sessionStorage.getItem("username")}getDisplayName(){return sessionStorage.getItem("displayName")||sessionStorage.getItem("username")}getAvatar(){return sessionStorage.getItem("userAvatar")}getPassword(){return sessionStorage.getItem("userPassword")}setPassword(e){sessionStorage.setItem("userPassword",e)}isLoggedIn(){return this.hasToken()}hasToken(){return!!sessionStorage.getItem(this.tokenKey)}static \u0275fac=function(t){return new(t||r)(n(o))};static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{g as a};
