import{I as s,M as n,Q as o,h as a,lc as i,mc as g}from"./chunk-FRE54O45.js";var u=class r{constructor(e){this.http=e}apiUrl="https://pokedex-backend-mwcz.onrender.com/api/auth";tokenKey="token";isLoggedInSubject=new a(this.hasToken());isLoggedIn$=this.isLoggedInSubject.asObservable();login(e){return this.http.post(`${this.apiUrl}/login`,e).pipe(s(t=>{this.saveUserData(t),sessionStorage.setItem("userPassword",e.password),this.isLoggedInSubject.next(!0)}))}register(e){return this.http.post(`${this.apiUrl}/register`,e).pipe(s(t=>{this.saveUserData(t),sessionStorage.setItem("userPassword",e.password),this.isLoggedInSubject.next(!0)}))}updateProfile(e){let t=new i({Authorization:`Bearer ${this.getToken()}`});return this.http.put(`${this.apiUrl}/profile`,e,{headers:t}).pipe(s(p=>{this.saveUserData(p)}))}logout(){sessionStorage.clear(),this.isLoggedInSubject.next(!1)}deleteAccount(){let e=new i({Authorization:`Bearer ${this.getToken()}`});return this.http.delete(`${this.apiUrl}/delete-account`,{headers:e,responseType:"text"}).pipe(s(()=>{sessionStorage.clear(),this.isLoggedInSubject.next(!1)}))}saveUserData(e){sessionStorage.setItem(this.tokenKey,e.token),sessionStorage.setItem("username",e.username),sessionStorage.setItem("email",e.email),e.displayName&&sessionStorage.setItem("displayName",e.displayName),e.bio&&sessionStorage.setItem("userBio",e.bio),e.gender&&sessionStorage.setItem("userGender",e.gender),e.favoriteRegion&&sessionStorage.setItem("userFavoriteRegion",e.favoriteRegion),e.language&&sessionStorage.setItem("userLanguage",e.language),e.avatar&&sessionStorage.setItem("userAvatar",e.avatar)}getToken(){return sessionStorage.getItem(this.tokenKey)}getUsername(){return sessionStorage.getItem("username")}getDisplayName(){return sessionStorage.getItem("displayName")||sessionStorage.getItem("username")}getAvatar(){return sessionStorage.getItem("userAvatar")}getPassword(){return sessionStorage.getItem("userPassword")}setPassword(e){sessionStorage.setItem("userPassword",e)}isLoggedIn(){return this.hasToken()}hasToken(){return!!sessionStorage.getItem(this.tokenKey)}static \u0275fac=function(t){return new(t||r)(o(g))};static \u0275prov=n({token:r,factory:r.\u0275fac,providedIn:"root"})};export{u as a};
