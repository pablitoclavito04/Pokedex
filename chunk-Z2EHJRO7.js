import{a as f}from"./chunk-SYVWD7B3.js";import{a as d}from"./chunk-ZOOKMLVN.js";import{d as g}from"./chunk-3HSYOFWU.js";import{H as h,L as u,Q as m,h as l,k as o,p as s,y as i}from"./chunk-YPKSWN7B.js";var k=class c{http=m(g);loadingService=m(d);toastService=m(f);API_URL="https://pokeapi.co/api/v2/pokemon";SPECIES_URL="https://pokeapi.co/api/v2/pokemon-species";pokemonCache=new Map;spanishNamesCache=new Map;spanishNamesLoaded=!1;currentPokemonSubject=new l(null);currentPokemon$=this.currentPokemonSubject.asObservable();isLoadingSubject=new l(!1);isLoading$=this.isLoadingSubject.asObservable();typeColors={normal:"#A8A878",fire:"#F08030",water:"#6890F0",electric:"#F8D030",grass:"#78C850",ice:"#98D8D8",fighting:"#C03028",poison:"#A040A0",ground:"#E0C068",flying:"#A890F0",psychic:"#F85888",bug:"#A8B820",rock:"#B8A038",ghost:"#705898",dragon:"#7038F8",dark:"#705848",steel:"#B8B8D0",fairy:"#EE99AC"};statNames={hp:"PS",attack:"Ataque",defense:"Defensa","special-attack":"At. Esp.","special-defense":"Def. Esp.",speed:"Velocidad"};typeNamesSpanish={normal:"Normal",fire:"Fuego",water:"Agua",electric:"El\xE9ctrico",grass:"Planta",ice:"Hielo",fighting:"Lucha",poison:"Veneno",ground:"Tierra",flying:"Volador",psychic:"Ps\xEDquico",bug:"Bicho",rock:"Roca",ghost:"Fantasma",dragon:"Drag\xF3n",dark:"Siniestro",steel:"Acero",fairy:"Hada"};getPokemonById(t){if(this.pokemonCache.has(t)){let e=this.pokemonCache.get(t);return this.currentPokemonSubject.next(e),o(e)}return this.isLoadingSubject.next(!0),this.loadingService.show(),this.http.get(`${this.API_URL}/${t}`).pipe(s(e=>this.transformPokemonData(e)),h(e=>{this.pokemonCache.set(t,e),this.currentPokemonSubject.next(e),this.isLoadingSubject.next(!1),this.loadingService.hide()}),i(e=>{throw this.isLoadingSubject.next(!1),this.loadingService.hide(),this.toastService.error(`Error al cargar el Pok\xE9mon #${t}`),console.error("Error fetching Pokemon:",e),e}))}getPokemonByName(t){return this.isLoadingSubject.next(!0),this.loadingService.show(),this.http.get(`${this.API_URL}/${t.toLowerCase()}`).pipe(s(e=>this.transformPokemonData(e)),h(e=>{this.pokemonCache.set(e.id,e),this.currentPokemonSubject.next(e),this.isLoadingSubject.next(!1),this.loadingService.hide()}),i(e=>{throw this.isLoadingSubject.next(!1),this.loadingService.hide(),this.toastService.error(`Error al cargar el Pok\xE9mon "${t}"`),console.error("Error fetching Pokemon:",e),e}))}getPokemonList(t=0,e=20){return this.isLoadingSubject.next(!0),this.http.get(`${this.API_URL}?offset=${t}&limit=${e}`).pipe(s(r=>r.results.map(a=>{let n=a.url.split("/"),p=parseInt(n[n.length-2]);return{id:p,name:this.capitalizeFirstLetter(this.cleanPokemonName(a.name)),image:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${p}.png`,types:[],stats:[],height:0,weight:0}})),h(()=>this.isLoadingSubject.next(!1)),i(r=>(this.isLoadingSubject.next(!1),this.toastService.error("Error al cargar los Pok\xE9mon"),console.error("Error fetching Pokemon list:",r),o([]))))}getAllPokemonNames(){if(this.spanishNamesLoaded&&this.spanishNamesCache.size>0){let t=[];return this.spanishNamesCache.forEach((e,r)=>{t.push({id:r,name:e})}),o(t.sort((e,r)=>e.id-r.id))}return this.http.get("assets/data/pokemon-names-es.json").pipe(s(t=>{let e=[];return Object.entries(t).forEach(([r,a])=>{let n=parseInt(r);this.spanishNamesCache.set(n,a),e.push({id:n,name:a})}),this.spanishNamesLoaded=!0,e.sort((r,a)=>r.id-a.id)}),i(t=>(console.error("Error loading Spanish names, falling back to API:",t),this.http.get(`${this.API_URL}?limit=1025`).pipe(s(e=>e.results.map(r=>{let a=r.url.split("/");return{id:parseInt(a[a.length-2]),name:this.capitalizeFirstLetter(this.cleanPokemonName(r.name))}})),i(e=>(console.error("Error fetching all Pokemon names:",e),o([])))))))}getSpanishName(t){return this.spanishNamesCache.get(t)||`Pok\xE9mon #${t}`}getPokemonDetails(t){return this.pokemonCache.has(t)?o(this.pokemonCache.get(t)):this.http.get(`${this.API_URL}/${t}`).pipe(s(e=>{let r=this.transformPokemonData(e);return this.spanishNamesCache.has(t)&&(r.name=this.spanishNamesCache.get(t)),r}),h(e=>this.pokemonCache.set(t,e)),i(e=>{throw console.error("Error fetching Pokemon details:",e),e}))}searchPokemon(t,e){let r=t.toLowerCase().trim();return r?e.filter(a=>a.name.toLowerCase().includes(r)||a.id.toString().includes(r)):e}transformPokemonData(t){let e=t.id,r=this.spanishNamesCache.has(e)?this.spanishNamesCache.get(e):this.capitalizeFirstLetter(this.cleanPokemonName(t.name));return{id:e,name:r,image:t.sprites.other["official-artwork"].front_default,types:t.types.map(a=>({name:this.capitalizeFirstLetter(a.type.name),color:this.typeColors[a.type.name]||"#777777"})),stats:t.stats.map(a=>({name:this.statNames[a.stat.name]||a.stat.name,value:a.base_stat})),height:t.height/10,weight:t.weight/10}}capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)}cleanPokemonName(t){let e=["-altered","-origin","-land","-sky","-normal","-attack","-defense","-speed","-plant","-sandy","-trash","-heat","-wash","-frost","-fan","-mow","-standard","-zen","-ordinary","-resolute","-aria","-pirouette","-incarnate","-therian","-black","-white","-50","-10","-average","-small","-large","-super","-confined","-unbound","-baile","-pom-pom","-pau","-sensu","-midday","-midnight","-dusk","-solo","-school","-meteor","-core","-disguised","-busted","-red-striped","-blue-striped","-shield","-blade","-male","-female","-single-strike","-rapid-strike","-ice","-shadow","-hero","-full-belly","-hangry","-green-plumage","-yellow-plumage","-blue-plumage","-white-plumage","-chest","-roaming","-combat","-blaze","-aqua","-family-of-three","-family-of-four","-curly","-droopy","-stretchy","-three-segment","-four-segment","-zero","-counterfeit","-artisan","-masterpiece"],r=t.toLowerCase();for(let a of e)if(r.endsWith(a)){r=r.replace(a,"");break}return r}getTypeColor(t){return this.typeColors[t.toLowerCase()]||"#777777"}getTypeNameSpanish(t){return this.typeNamesSpanish[t.toLowerCase()]||t}getCurrentPokemon(){return this.currentPokemonSubject.getValue()}clearCurrentPokemon(){this.currentPokemonSubject.next(null)}clearCache(){this.pokemonCache.clear()}static \u0275fac=function(e){return new(e||c)};static \u0275prov=u({token:c,factory:c.\u0275fac,providedIn:"root"})};export{k as a};
